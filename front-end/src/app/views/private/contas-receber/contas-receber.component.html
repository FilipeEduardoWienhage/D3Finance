<app-header-system></app-header-system>
<div class="flex flex-row flex-grow px-4 gap-4">
    <div class="flex-shrink-0">
        <app-nav-bar-system></app-nav-bar-system>
    </div>

    <div class="flex flex-col flex-grow space-y-6 items-center">
        <div class="flex justify-end w-full">
            <button pButton label="Nova Conta" icon="pi pi-plus" class="p-button-success mb-3" (click)="abrirDialog()">
            </button>
        </div>
        <p-table [value]="itens" showGridlines [tableStyle]="{ 'min-width': '50rem' }">
            <ng-template #header>
                <tr>
                    <th>Conta</th>
                    <th>Descrição</th>
                    <th>Valor</th>
                    <th>Data prevista</th>
                    <th>Categoria da receita</th>
                    <th>Forma de Recebimento</th>
                    <th>Status</th>
                    <th>Ações </th>
                </tr>
            </ng-template>
            <ng-template #body let-item>
                <tr>
                    <td>{{ item.conta }}</td>
                    <td>{{ item.descricao }}</td>
                    <td>{{ item.valor }}</td>
                    <td>{{ item.dataPrevista }}</td>
                    <td>{{ item.categoriaReceita }}</td>
                    <td>{{ item.formaRecebimento }}</td>
                    <td>{{ item.status }}</td>
                    <td>
                        <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text"
                            (click)="editarConta(item)">
                        </button>

                        <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text"
                            (click)="excluirConta(item.id)">
                        </button>

                        <button pButton icon="pi pi-check" class="p-button-rounded p-button-text"
                            *ngIf="item.status === 'pendente'" (click)="marcarComoPago(item)">
                        </button>
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <p-dialog header="Cadastrar Conta a Receber" [(visible)]="dialogVisible" [modal]="true"
            [style]="{width: '500px'}" [closable]="true">
            <form (ngSubmit)="salvarConta()" #contaForm="ngForm" class="space-y-4">

                <div class="flex flex-col">
                    <label>Conta</label>
                    <input pInputText [(ngModel)]="novaConta.conta" name="conta" required />
                </div>

                <div class="flex flex-col">
                    <label>Descrição</label>
                    <input pInputText [(ngModel)]="novaConta.descricao" name="descricao" />
                </div>

                <div class="flex flex-col">
                    <label>Valor</label>
                    <p-inputnumber [(ngModel)]="RequestContasReceber.valor" inputId="currency-br" mode="currency"
                    currency="BRL" locale="pt-BR" />
                </div>

                <div class="flex flex-col">
                    <label>Data Prevista</label>
                    <p-datepicker [(ngModel)]="novaConta.dataPrevista" name="dataPrevista" dateFormat="dd/mm/yy"
                        aria-placeholder="dd/mm/aaaa" showIcon="true"></p-datepicker>
                </div>

                <div class="flex flex-col">
                    <label>Categoria da Receita</label>
                    <p-select [options]="categoriaDaReceita" [(ngModel)]="RequestContasReceber.categoriaReceita"
                        optionLabel="name" optionValue="name" placeholder="Categoria da Receita"></p-select>
                </div>

                <div class="flex flex-col">
                    <label>Forma de Recebimento</label>
                    <p-select [options]="formaDeRecebimento" [(ngModel)]="RequestContasReceber.formaRecebimento"
                        optionLabel="name" optionValue="name" placeholder="Forma de Recebimento"></p-select>
                </div>

                <div class="flex justify-end gap-2 mt-4">
                    <button pButton label="Cancelar" class="p-button-text" type="button"
                        (click)="fecharDialog()"></button>
                    <button pButton label="Salvar" icon="pi pi-check" type="submit"
                        [disabled]="contaForm.invalid"></button>
                </div>
            </form>
        </p-dialog>
    </div>




</div>
<app-footer class="mt-auto"></app-footer>